{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">

    <title>Masterkart - الگوی HTML تجارت الکترونیک چند منظوره</title>
    <meta name="keywords"
          content="Bootstrap 5.x, ecommerce, farming, food market, grocery market, grocery shop, grocery store, grocery supper market, multi vendor, organic food, supermarket, supermarket grocery">
    <meta name="description" content="Multipurpose eCommerce HTML Template">
    <meta name="author" content="Pilarest">

    <!-- site Favicon -->
    <link rel="icon" href="{% static 'assets/img/favicon/favicon.png' %}" sizes="32x32">

    <!-- css Icon Font -->
    <link rel="stylesheet" href="{% static 'assets/css/vendor/msicons.min.css' %}">

    <!-- css All Plugins Files -->
    <link rel="stylesheet" href="{% static 'assets/css/plugins/animate.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/plugins/bootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/plugins/bootstrap-select.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/plugins/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/plugins/owl.theme.default.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/plugins/swiper-bundle.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/plugins/slick.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/plugins/nouislider.css' %}">

    <!-- Main Style -->
    <link rel="stylesheet" id="main_style" href="{% static 'assets/css/style.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/responsive.css' %}">
    <link rel="stylesheet" class="color-css" href="{% static 'assets/css/color-01.css' %}">
    <link rel="stylesheet" href="https://static.neshan.org/sdk/leaflet/v1.9.4/neshan-sdk/v1.0.8/index.css"/>
    <style>
        /* استایل برای دکمه‌ها */
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            margin: 5px;
        }

        .verify-btn {
            background-color: green; /* پس‌زمینه سبز */
            color: white; /* متن سفید */
        }

        .verify-btn:hover {
            background-color: darkgreen; /* تغییر رنگ پس‌زمینه هنگام هاور */
        }

        .cancel-btn {
            background-color: transparent; /* پس‌زمینه شفاف */
            color: red; /* متن قرمز */
            border: 2px solid red; /* حاشیه قرمز */
        }

        .cancel-btn:hover {
            background-color: red; /* تغییر رنگ پس‌زمینه به قرمز */
            color: white; /* تغییر رنگ متن به سفید */
        }

        /* استایل دیالوگ‌ها */
        .dialog {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .dialog-content {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            width: 400px;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
        }

        /* استایل برای دکمه‌ها */
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            margin: 5px;
        }

        .save-btn {
            background-color: green; /* پس‌زمینه سبز */
            color: white; /* متن سفید */
        }

        .save-btn:hover {
            background-color: darkgreen; /* تغییر رنگ پس‌زمینه هنگام هاور */
        }

        .cancel-btn {
            background-color: transparent; /* پس‌زمینه شفاف */
            color: red; /* متن قرمز */
            border: 2px solid red; /* حاشیه قرمز */
        }

        .cancel-btn:hover {
            background-color: red; /* تغییر رنگ پس‌زمینه به قرمز */
            color: white; /* تغییر رنگ متن به سفید */
        }

        textarea, input[type="text"] {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            resize: vertical; /* امکان تغییر اندازه برای textarea */
        }

        .dialog {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .dialog-content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            width: 300px;
            text-align: center;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            cursor: pointer;
        }

    </style>
</head>

<body>
<!-- Loader -->
<div id="ms-overlay">
    <div class="loader"></div>
</div>

<!-- Header start  -->
{% include '../extentions/header.html' with categories=categories_map %}
<!-- Header End  -->
<div class="ms-breadcrumb m-b-30">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="row ms_breadcrumb_inner">
                    <div class="col-md-6 col-sm-12">
                        <h2 class="ms-breadcrumb-title">پروفایل شما</h2>
                    </div>
                    <div class="col-md-6 col-sm-12">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Breadcrumb end -->

<!-- Register section -->
<section class="ms-register padding-tb-30">
    <div class="row p-t-15">
        <div class="ms-register-wrapper">
            <div class="ms-register-container">
                <div class="ms-register-form">
                    <form action="#" method="post">
                                <span class="ms-register-wrap ms-register-half">
                                    <label>نام *</label>
                                    <input id="edit-firstname" type="text" name="firstname" placeholder="نام" readonly
                                           onclick="openEditDialog('نام','edit-firstname')">
                                </span>

                        <span class="ms-register-wrap ms-register-half">
                                    <label>نام خانوادگی *</label>
                                    <input id="edit-lastname" type="text" name="lastname" placeholder="نام خانوادگی"
                                           readonly
                                           onclick="openEditDialog('نام خانوادگی','edit-lastname')">
                                </span>
                        <span class="ms-register-wrap ms-register-half">
                                    <label>ایمیل *</label>
                                    <input type="email" name="email" onclick="openVerificationDialog()"
                                           placeholder="ایمیل" readonly required>
                                </span>
                        <span class="ms-register-wrap ms-register-half">
                                    <label>تلفن *</label>
                                    <input type="text" name="phonenumber" onclick="openMobileVerificationDialog()"
                                           readonly placeholder="تلفن" required>
                                </span>
                        <span class="ms-register-wrap ms-register-half">
                                    <label>لوکیشن</label>
                                            <input type="text" name="postalcode" id="postalcode" placeholder="برای انتخاب نقشه کلیک کنید" onclick="openMapDialog()">                                </span>
                        <span class="ms-register-wrap ms-register-half">
                                    <label>کدپستی</label>
                                    <input type="text" id="edit-post-code" name="postalcode" placeholder="کدپستی"
                                           readonly onclick="openEditDialog('کدپستی','edit-post-code')">
                                </span>
                        <span class="ms-register-wrap">
                                    <label>آدرس</label>
                                    <input type="text" id="edit-address" name="address" placeholder="آدرس" readonly
                                           onclick="openEditDialog('آدرس','edit-address',true)">
                                </span>
                        <span class="ms-register-wrap ms-recaptcha">
                                    <span class="g-recaptcha" data-sitekey="6LfKURIUAAAAAO50vlwWZkyK_G2ywqE52NU7YO0S"
                                          data-callback="verifyRecaptchaCallback"
                                          data-expired-callback="expiredRecaptchaCallback"></span>
                                <input class="form-control d-none" data-recaptcha="true" required
                                       data-error="Please complete the Captcha">
                                <span class="help-block with-errors"></span>
                                </span>
                        {#                                <span class="ms-register-wrap ms-register-btn">#}
                        {#                                    <span>از قبل حساب کاربری دارید؟<a href="login.html">ورود</a></span>#}
                        {#                                <button class="ms-btn-2" type="submit">ثبت نام</button>#}
                        {#                                </span>#}
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Dialog Box -->
<!-- Dialog Box -->
<!-- Dialog Box -->
<!-- Dialog Box -->
<div id="editDialog" class="dialog">
    <div class="dialog-content">
        <span id="closeDialog" class="close-btn">&times;</span>
        <label for="edit-input" id="dialog-title">نام</label> <!-- تغییر به ID برای تغییر عنوان -->

        <!-- Input/textarea will be dynamically added here -->
        <div id="input-container"></div> <!-- جایی که input یا textarea در آن قرار می‌گیرد -->

        <!-- دکمه‌های ذخیره و کنسل -->
        <button id="save-btn" class="save-btn">ذخیره</button>
        <button id="cancel-btn" class="cancel-btn">کنسل</button>
    </div>
</div>
{#verify dialog#}
<!-- Dialog Box for Email Verification -->
<div id="verificationDialog" class="dialog">
    <div class="dialog-content">
        <span id="closeVerificationDialog" class="close-btn">&times;</span>
        <label for="verification-input" id="verification-title">ایمیل خود را وارد کنید</label>

        <!-- Input field for email -->
        <div id="input-container">
            <input type="email" id="verification-input" placeholder="ایمیل خود را وارد کنید">
        </div>

        <!-- دکمه‌های تایید و لغو -->
        <button id="verify-btn" class="verify-btn">تایید</button>
        <button id="cancel-btn" class="cancel-btn">لغو</button>
    </div>
</div>

<!-- Dialog Box for Code Verification -->
<div id="codeDialog" class="dialog">
    <div class="dialog-content">
        <span id="closeCodeDialog" class="close-btn">&times;</span>
        <label for="verification-code-input" id="code-title">کد تایید ۴ رقمی را وارد کنید</label>

        <!-- Input field for code verification -->
        <div id="code-input-container">
            <input type="text" id="verification-code-input" placeholder="کد تایید" maxlength="4">
        </div>

        <!-- دکمه‌های تایید و لغو -->
        <button id="confirm-code-btn" class="confirm-code-btn">تایید کد</button>
        <button id="cancel-code-btn" class="cancel-code-btn">لغو</button>
    </div>
</div>
{#mobile verify#}
<!-- Dialog Box for Mobile Verification -->
<div id="mobileVerificationDialog" class="dialog">
    <div class="dialog-content">
        <span id="closeMobileVerificationDialog" class="close-btn">&times;</span>
        <label for="mobile-verification-input" id="mobile-verification-title">شماره موبایل خود را وارد کنید</label>

        <!-- Input field for mobile -->
        <div id="mobile-input-container">
            <input type="text" id="mobile-verification-input" placeholder="شماره موبایل خود را وارد کنید"
                   maxlength="11">
        </div>

        <!-- دکمه‌های تایید و لغو -->
        <button id="verify-mobile-btn" class="verify-btn">تایید</button>
        <button id="cancel-mobile-btn" class="cancel-btn">لغو</button>
    </div>
</div>

<!-- Dialog Box for Code Verification (Mobile) -->
<div id="mobileCodeDialog" class="dialog">
    <div class="dialog-content">
        <span id="closeMobileCodeDialog" class="close-btn">&times;</span>
        <label for="mobile-verification-code-input" id="mobile-code-title">کد تایید ۴ رقمی را وارد کنید</label>

        <!-- Input field for code verification -->
        <div id="mobile-code-input-container">
            <input type="text" id="mobile-verification-code-input" placeholder="کد تایید" maxlength="4">
        </div>

        <!-- دکمه‌های تایید و لغو -->
        <button id="confirm-mobile-code-btn" class="confirm-code-btn">تایید کد</button>
        <button id="cancel-mobile-code-btn" class="cancel-code-btn">لغو</button>
    </div>
</div>
<!-- دیالوگ نقشه --> 

<!-- دیالوگ نقشه -->
<div id="mapDialog" class="dialog">
    <div class="dialog-content">
        <span id="closeMapDialog" class="close-btn">&times;</span>
        <div id="map" style="width: 100%; height: 400px;"></div> <!-- مکان نمایش نقشه -->
        <button id="saveLocation" class="save-btn">ذخیره مکان</button>
    </div>
</div>

<!-- پیام برای نمایش مختصات انتخابی -->
<p id="selectedLocation"></p>
<!-- پیام برای نمایش مختصات انتخابی -->
<p id="selectedLocation"></p>
<!-- Footer Start -->
{% include '../extentions/footer.html' %}
<!-- Footer Area End -->

<!-- Back to top  -->
<a class="ms-back-to-top"></a>

<!-- Features sidebar  -->
<div class="ms-features-sidebar-overlay"></div>
<div class="ms-features-sidebar">
    <div class="tool-title">
        <h3>تنظیمات</h3>
    </div>
    <a href="#" class="ms-tools-sidebar-toggle open-features">
        <img alt="icon" src="{% static 'assets/img/icons/setting.svg' %}" class="svg_img">
    </a>
    <div class="ms-features-block">
        <div class="ms-features-title">رنگ‌ها</div>
        <ul class="bg-panel ms-change-color">
            <li class="active" data-color="01">
                <a href="javascript:void(0)" class="colorcode1"></a>
            </li>
            <li data-color="02">
                <a href="javascript:void(0)" class="colorcode2"></a>
            </li>
            <li data-color="03">
                <a href="javascript:void(0)" class="colorcode3"></a>
            </li>
            <li data-color="04">
                <a href="javascript:void(0)" class="colorcode4"></a>
            </li>
            <li data-color="05">
                <a href="javascript:void(0)" class="colorcode5"></a>
            </li>
            <li data-color="06">
                <a href="javascript:void(0)" class="colorcode6"></a>
            </li>
            <li data-color="07" class="">
                <a href="javascript:void(0)" class="colorcode7"></a>
            </li>
            <li data-color="08">
                <a href="javascript:void(0)" class="colorcode8"></a>
            </li>
            <li data-color="09">
                <a href="javascript:void(0)" class="colorcode9"></a>
            </li>
        </ul>
    </div>
    <div class="ms-features-block">
        <div class="ms-tools-sidebar-content">
            <div class="ms-features-title">حالت پس رمینه</div>
            <div class="ms-change-mode active" id="ms-change-mode">
                <div class="ms-mode-switch">
                    <div class="ms-mode-btn">انتخاب</div>
                    <div class="ms-mode-on">روشن</div>
                    <div class="ms-mode-off">خاموش</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Plugins JS -->
<script src="{% static 'assets/js/plugins/jquery-3.5.1.min.js' %}"></script>
<script src="{% static 'assets/js/plugins/popper.min.js' %}"></script>
<script src="{% static 'assets/js/plugins/bootstrap.bundle.min.js' %}"></script>
<script src="{% static 'assets/js/plugins/bootstrap-select.min.js' %}"></script>
<script src="{% static 'assets/js/plugins/fontawesome.js' %}"></script>
<script src="{% static 'assets/js/plugins/owl.carousel.min.js' %}"></script>
<script src="{% static 'assets/js/plugins/swiper-bundle.min.js' %}"></script>
<script src="{% static 'assets/js/plugins/infiniteslidev2.js' %}"></script>
<script src="{% static 'assets/js/plugins/jquery.zoom.min.js' %}"></script>
<script src="{% static 'assets/js/plugins/slick.min.js' %}"></script>
<script src="{% static 'assets/js/plugins/nouislider.js' %}"></script>
<script src="https://static.neshan.org/sdk/leaflet/v1.9.4/neshan-sdk/v1.0.8/index.js"></script>
<script src="{% static 'assets/js/main.js' %}"></script>
<script>
    function openEditDialog(title, filedId, isTextarea) {
        var inputField = document.getElementById(filedId);
        inputField.disabled = false;

        // تغییر عنوان دیالوگ
        document.getElementById('dialog-title').innerText = title;

        // ایجاد و نمایش input یا textarea بر اساس پارامتر isTextarea
        var inputContainer = document.getElementById('input-container');
        inputContainer.innerHTML = ''; // ابتدا محتوای قبلی را پاک می‌کنیم

        var inputElement;
        if (isTextarea) {
            inputElement = document.createElement('textarea');
            inputElement.id = 'edit-input';
            inputElement.placeholder = title;
        } else {
            inputElement = document.createElement('input');
            inputElement.type = 'text';
            inputElement.id = 'edit-input';
            inputElement.placeholder = title;
        }

        inputElement.value = inputField.value; // مقدار فعلی فیلد ورودی را به input جدید انتقال می‌دهیم
        inputContainer.appendChild(inputElement); // اضافه کردن فیلد به container

        // نمایش دیالوگ
        document.getElementById('editDialog').style.display = 'flex';

        // بستن دیالوگ با کلیک روی close
        document.getElementById('closeDialog').addEventListener('click', function () {
            document.getElementById('editDialog').style.display = 'none';
        });

        // ذخیره تغییرات
        document.getElementById('save-btn').addEventListener('click', function () {
            var editedValue = document.getElementById('edit-input').value;
            inputField.value = editedValue; // ذخیره مقدار ویرایش شده
            document.getElementById('editDialog').style.display = 'none'; // بستن دیالوگ
        });

        // کنسل کردن تغییرات
        document.getElementById('cancel-btn').addEventListener('click', function () {
            document.getElementById('editDialog').style.display = 'none'; // بستن دیالوگ بدون ذخیره
        });
    }
    var verificationCode = '1234';
    function openVerificationDialog() {
        // نمایش دیالوگ ورود ایمیل
        document.getElementById('verificationDialog').style.display = 'flex';

        // بستن دیالوگ با کلیک روی close
        document.getElementById('closeVerificationDialog').addEventListener('click', function () {
            document.getElementById('verificationDialog').style.display = 'none';
        });

        // دکمه تایید ایمیل
        document.getElementById('verify-btn').addEventListener('click', function () {
            var email = document.getElementById('verification-input').value;

            if (validateEmail(email)) {
                // ایمیل صحیح است، حالا کد تایید ارسال می‌شود و دیالوگ بعدی نمایش داده می‌شود
                alert('کد تایید به ایمیل شما ارسال شد!');
                document.getElementById('verificationDialog').style.display = 'none'; // بستن دیالوگ ورود ایمیل
                openCodeVerificationDialog(); // باز کردن دیالوگ وارد کردن کد تایید
            } else {
                alert('لطفا یک ایمیل معتبر وارد کنید.');
            }
        });

        // دکمه لغو
        document.getElementById('cancel-btn').addEventListener('click', function () {
            document.getElementById('verificationDialog').style.display = 'none'; // بستن دیالوگ
        });
    }
    function validateEmail(email) {
        var emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
        return emailRegex.test(email);
    }
    function openCodeVerificationDialog() {
        // نمایش دیالوگ ورود کد تایید
        document.getElementById('codeDialog').style.display = 'flex';

        // بستن دیالوگ با کلیک روی close
        document.getElementById('closeCodeDialog').addEventListener('click', function () {
            document.getElementById('codeDialog').style.display = 'none';
        });

        // دکمه تایید کد
        document.getElementById('confirm-code-btn').addEventListener('click', function () {
            var code = document.getElementById('verification-code-input').value;
            if (code === verificationCode) {
                alert('کد تایید صحیح بود!');
                document.getElementById('codeDialog').style.display = 'none'; // بستن دیالوگ کد تایید
            } else {
                alert('کد تایید صحیح نمی‌باشد');
            }
        });

        // دکمه لغو
        document.getElementById('cancel-code-btn').addEventListener('click', function () {
            document.getElementById('codeDialog').style.display = 'none'; // بستن دیالوگ کد تایید
        });
    }
    function openMobileVerificationDialog() {
        // نمایش دیالوگ ورود شماره موبایل
        document.getElementById('mobileVerificationDialog').style.display = 'flex';

        // بستن دیالوگ با کلیک روی close
        document.getElementById('closeMobileVerificationDialog').addEventListener('click', function () {
            document.getElementById('mobileVerificationDialog').style.display = 'none';
        });

        // دکمه تایید شماره موبایل
        document.getElementById('verify-mobile-btn').addEventListener('click', function () {
            var mobileNumber = document.getElementById('mobile-verification-input').value;

            if (validateMobileNumber(mobileNumber)) {
                // شماره موبایل صحیح است، حالا کد تایید ارسال می‌شود و دیالوگ بعدی نمایش داده می‌شود
                alert('کد تایید به شماره موبایل شما ارسال شد!');
                document.getElementById('mobileVerificationDialog').style.display = 'none'; // بستن دیالوگ ورود موبایل
                openMobileCodeVerificationDialog(); // باز کردن دیالوگ وارد کردن کد تایید
            } else {
                alert('لطفا یک شماره موبایل معتبر وارد کنید.');
            }
        });

        // دکمه لغو
        document.getElementById('cancel-mobile-btn').addEventListener('click', function () {
            document.getElementById('mobileVerificationDialog').style.display = 'none'; // بستن دیالوگ
        });
    } 
    function validateMobileNumber(mobileNumber) {
        var mobileRegex = /^(09)[0-9]{9}$/; // اعتبارسنجی شماره موبایل (برای ایران)
        return mobileRegex.test(mobileNumber);
    } 
    function openMobileCodeVerificationDialog() {
        // نمایش دیالوگ وارد کردن کد تایید
        document.getElementById('mobileCodeDialog').style.display = 'flex';

        // بستن دیالوگ با کلیک روی close
        document.getElementById('closeMobileCodeDialog').addEventListener('click', function () {
            document.getElementById('mobileCodeDialog').style.display = 'none';
        });

        // دکمه تایید کد
        document.getElementById('confirm-mobile-code-btn').addEventListener('click', function () {
            var code = document.getElementById('mobile-verification-code-input').value;
            if (code === verificationCode) {
                alert('کد تایید صحیح بود!');
                document.getElementById('mobileCodeDialog').style.display = 'none'; // بستن دیالوگ کد تایید
            } else {
                alert('کد تایید صحیح نمی‌باشد');
            }
        });

        // دکمه لغو
        document.getElementById('cancel-mobile-code-btn').addEventListener('click', function () {
            document.getElementById('mobileCodeDialog').style.display = 'none'; // بستن دیالوگ کد تایید
        });
    } 
</script>

<script>
   let map;
    let marker;
    let selectedLocation = { lat: 35.6895, lng: 51.3890 }; // موقعیت پیش‌فرض (تهران)

    function openMapDialog() {
        // نمایش دیالوگ نقشه
        document.getElementById('mapDialog').style.display = 'flex';

        // فقط در صورتی نقشه را مقداردهی می‌کنیم که هنوز ایجاد نشده باشد
        if (!map) {
            initMap();
        }

        // بستن دیالوگ
        document.getElementById('closeMapDialog').addEventListener('click', function () {
            document.getElementById('mapDialog').style.display = 'none';
        });

        // ذخیره مکان انتخابی
        document.getElementById('saveLocation').addEventListener('click', function () {
            document.getElementById('postalcode').value = `Latitude: ${selectedLocation.lat}, Longitude: ${selectedLocation.lng}`;
            document.getElementById('mapDialog').style.display = 'none';
        });
    }

    function initMap() {
        // ایجاد نقشه
        map = new L.Map("map", {
            key: "web.3188f8eb47ad4ebebec20e3bb4bc9a11", // اینجا باید API Key خود را قرار دهید
            maptype: "neshan",
            poi: false,
            traffic: false,
            center: selectedLocation, // مرکز نقشه
            zoom: 14, // سطح زوم
        });

        // ایجاد مارکر در موقعیت پیش‌فرض
        marker = new L.Marker(selectedLocation, { draggable: true }).addTo(map);

        // رویداد برای کلیک روی نقشه
        map.on('click', function (event) {
            const clickedLocation = event.latlng;
            selectedLocation = clickedLocation;

            // تغییر مکان مارکر
            marker.setLatLng(clickedLocation);
        });

        // رویداد برای جابجایی مارکر
        marker.on('dragend', function () {
            selectedLocation = marker.getLatLng();
        });
    }
</script>
</body>

</html>